<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é»‘å¤œå›ä¸´åœ°å›¾ç­›é€‰</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="description" content="åŸºäºå…´è¶£ç‚¹ä½ç½®è¯†åˆ«ã€Šè‰¾å°”ç™»æ³•ç¯ å¤œä¹‹é™ä¸´ã€‹åœ°å›¾ç§å­çš„äº¤äº’å¼å·¥å…·">
    <meta name="keywords" content="è‰¾å°”ç™»æ³•ç¯, å¤œä¹‹é™ä¸´, åœ°å›¾, ç§å­, è¯†åˆ«, å…´è¶£ç‚¹, å·¥å…·">
    <link rel="icon" href="favicon.ico">
    <!-- Vercount PV/UV ç»Ÿè®¡è„šæœ¬ -->
    <script defer src="https://events.vercount.one/js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="top-actions">
                <button id="action-stats" class="action-btn" title="æŸ¥çœ‹è®¿é—®é‡">
                    <img src="assets/icons/fire.svg" alt="è®¿é—®é‡">
                </button>
                <button id="action-repo" class="action-btn" title="æŸ¥çœ‹åŸé¡¹ç›®">
                    <img src="assets/icons/star-fill.svg" alt="æŸ¥çœ‹åŸé¡¹ç›®">
                </button>
                <button id="action-help" class="action-btn" title="ä½¿ç”¨è¯´æ˜">
                    <i class="fas fa-book-open"></i>
                </button>
                <button id="action-tbd" class="action-btn" title="å¾…å®š">
                    <i class="fas fa-ellipsis"></i>
                </button>
                <div id="stats-popover" class="actions-popover" style="display: none;">
                    <div class="popover-body">
                        æœ¬ç«™æ€»è®¿å®¢æ•°: <span id="vercount_value_site_uv">Loading</span> äºº<br>
                        æœ¬ç«™æ€»è®¿é—®é‡: <span id="vercount_value_site_pv">Loading</span> æ¬¡<br>
                        <div class="popover-meta" style="border-top: 1px solid #4fc3f7; padding-top: 8px;">ç»Ÿè®¡æœåŠ¡ï¼šVercount</div>
                    </div>
                </div>
                <div id="repo-popover" class="actions-popover" style="display: none;">
                    <div class="popover-inner">
                        <div class="popover-title">
                            ğŸ™ æ±‚ä¸ªStar â­ï¸ æ„Ÿè°¢æ”¯æŒ ğŸ™
                        </div>
                        <div class="popover-body">
                            æœ¬ç«™GitHubä»“åº“
                            <a
                            href="https://github.com/xxiixi/NightreignMapseedFilter"
                            target="_blank"
                            rel="noopener noreferrer"
                            class="footer-link"
                        >
                            ç‚¹å‡»è·³è½¬
                        </a>
                        </div>
                    </div>
                </div>
            </div>
            <h1 class="title">
                <i class="fas fa-map"></i>
                é»‘å¤œå›ä¸´åœ°å›¾ç§å­ç­›é€‰å™¨
            </h1>
            <div class="subtitle">
                <p class="version">Version 1.0 | Nightreign version 1.01.3</p>
                <span id="cv-status" style="font-size: 12px; color: #6c757d; margin-left: 15px;"></span>
            </div>
        </header>

        <main class="main-content">

            <div id="loading-section" class="section" style="display: block;">
                <div class="loading-indicator">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>åˆå§‹åŒ–åœ°å›¾æ•°æ®ï¼Œè¯·ç¨å€™...</p>
                </div>
            </div>

            <div id="selection-section" class="section" style="display: none;">
                <div class="selection-grid">
                    <div class="selection-card">
                        <h3>é€‰æ‹©æƒ³è¦æŸ¥çœ‹çš„å¤œç‹</h3>
                        <p class="current-selection">å½“å‰é€‰æ‹©: <span id="chosen-nightlord">NONE</span></p>
                        <div class="button-grid">
                            <button class="nightlord-btn" data-nightlord="Gladius">"é»‘å¤œé‡å…½"æ ¼æ‹‰ç‹„ä¹Œæ–¯</button>
                            <button class="nightlord-btn" data-nightlord="Adel">"é»‘å¤œä¹‹çˆµ"è‰¾å¾·é›·</button>
                            <button class="nightlord-btn" data-nightlord="Gnoster">"é»‘å¤œä¹‹æ™º"æ ¼è¯ºæ–¯å¡”</button>
                            <button class="nightlord-btn" data-nightlord="Maris">"æ·±æµ·é»‘å¤œ"ç›ä¸½æ–¯</button>
                            <button class="nightlord-btn" data-nightlord="Libra">"é»‘å¤œä¹‹é­”"åˆ©æ™®æ‹‰</button>
                            <button class="nightlord-btn" data-nightlord="Fulghor">"é»‘å¤œå…‰éª‘å£«"å¼—æ ¼å°”</button>
                            <button class="nightlord-btn" data-nightlord="Caligo">"é»‘å¤œé›¾éœ¾"å¡è‰æœ</button>
                            <button class="nightlord-btn" data-nightlord="Heolstor">"é»‘å¤œç‹"å¸ƒå¾·å¥‡å†¥</button>
                        </div>
                    </div>

                    <div class="selection-card">
                        <h3>é€‰æ‹©æƒ³è¦æŸ¥çœ‹çš„ç‰¹æ®Šåœ°å½¢</h3>
                        <p class="current-selection">å½“å‰é€‰æ‹©: <span id="chosen-map">NONE</span></p>
                        <div class="button-grid">
                            <button class="map-btn" data-map="Default">é»˜è®¤</button>
                            <button class="map-btn" data-map="Mountaintop">å±±é¡¶</button>
                            <button class="map-btn" data-map="Crater">ç«å±±å£</button>
                            <button class="map-btn" data-map="Rotted Woods">è…è´¥æ£®æ—</button>
                            <button class="map-btn" data-map="Noklateo">éšåŸ</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="interaction-section" class="section" style="display: none;">
                <div class="instructions-card">
                    <h3><i class="fas fa-info-circle"></i> ä½¿ç”¨æ–¹å¼</h3>
                    <div class="instruction-grid">
                        <div class="instruction-item">
                            <i class="fas fa-mouse-pointer"></i>
                            <span><strong>å·¦é”®</strong> ç‚¹å‡»æ©™è‰²ç‚¹æ¥æ”¾ç½®æ•™å ‚</span>
                        </div>
                        <div class="instruction-item">
                            <i class="fas fa-hand-pointer"></i>
                            <span><strong>å³é”®</strong> é€‰æ‹© æ³•å¸ˆå¡” æˆ– è¶…çº§å•†äººçš„æ‘è½</span>
                        </div>
                    </div>
                    <div class="button-row">
                        <button id="reset-map-btn" class="reset-btn">
                            <i class="fas fa-undo"></i>
                            é‡ç½®åœ°å›¾ & ç§»é™¤æ‰€æœ‰æ ‡ç‚¹
                        </button>
                        
                        <button id="help-btn" class="help-btn">
                            <i class="fas fa-question-circle"></i>
                            å¸®åŠ© & å°æŠ€å·§
                        </button>
                    </div>
                </div>
            </div>

            <div id="results-section" class="section" style="display: none;">
                <div class="results-grid">
                    <div class="seed-counter">
                        <h3>å¯èƒ½çš„åœ°å›¾ç§å­</h3>
                        <div class="seed-count" id="seed-count">0</div>
                    </div>

                    <div class="map-container">
                        <canvas id="map-canvas" width="768" height="768"></canvas>
                        <div id="seed-image-container" style="display: none;"></div>
                        <div id="selection-overlay" class="selection-overlay">
                            <div class="overlay-message">
                                <i class="fas fa-map-marked-alt"></i>
                                <p>è¯·å…ˆåœ¨ä¸Šæ–¹é€‰æ‹©å¤œç‹ä¸åœ°å›¾ä»¥å¼€å§‹</p>
                                <small>é€‰æ‹©è®¾ç½®åå¼€å§‹è¯†åˆ«åœ°å›¾ç§å­</small>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-question-circle"></i> å¸®åŠ©ä¸æŠ€å·§</h3>
                <button class="close-btn" id="close-help">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h4><i class="fas fa-gamepad"></i> ä½¿ç”¨è¯´æ˜</h4>
                    <p>æ­¤å·¥å…·é€šè¿‡å¯¹æ¯”åœ°å›¾ä¸Šæ•™å ‚ä¸æ³•å¸ˆå¡”çš„ä½ç½®ï¼Œå¸®åŠ©ä½ è¯†åˆ«ã€Šå¤œä¹‹é™ä¸´ã€‹åœ°å›¾ç§å­ã€‚</p>
                    
                    <h4><i class="fas fa-list-ol"></i> é€æ­¥æŒ‡å—</h4>
                    <ol>
                        <li>ä»å¯é€‰é¡¹ä¸­é€‰æ‹©ä½ çš„<strong>å¤œç‹</strong></li>
                        <li>é€‰æ‹©ä½ çš„<strong>åœ°å›¾/å˜åŠ¨åœ°è²Œ</strong>ç±»å‹</li>
                        <li>æŸ¥çœ‹åœ°å›¾ä¸Šé«˜äº®çš„æ©™è‰²ç‚¹â€”â€”è¿™äº›æ˜¯å¯èƒ½çš„å…´è¶£ç‚¹ä½ç½®</li>
                        <li>ç‚¹å‡»è¿™äº›ç‚¹ï¼Œæ ‡è®°ä½ åœ¨æ¸¸æˆä¸­å®é™…çœ‹åˆ°çš„å†…å®¹ï¼š
                            <ul>
                                <li><strong>å·¦é”®</strong> = æ•™å ‚</li>
                                <li><strong>å³é”®</strong> = é€‰æ‹© æ³•å¸ˆå¡” æˆ– å…¶ä»–å…´è¶£ç‚¹</li>
                            </ul>
                        </li>
                        <li>éšç€ä½ é€æ­¥æ ‡è®°ï¼Œå¯èƒ½çš„ç§å­ä¼šè¢«ç­›å‡</li>
                        <li>å½“åªå‰©ä¸€ä¸ªåŒ¹é…æ—¶ï¼Œä½ å°†çœ‹åˆ°å®Œæ•´çš„ç§å­è¯¦æƒ…ä¸åœ°å›¾å›¾ç‰‡</li>
                    </ol>

                    <h4><i class="fas fa-lightbulb"></i> æç¤ºä¸å»ºè®®</h4>
                    <ul>
                        <li>å°½é‡æ ‡è®°ä½ åœ¨æ¸¸æˆä¸­èƒ½æ¸…æ™°çœ‹åˆ°çš„å°½å¯èƒ½å¤šçš„å…´è¶£ç‚¹</li>
                        <li>é€šè¿‡å³é”®èœå•é€‰æ‹© æ³•å¸ˆå¡”ã€å•†äººæ‘è½ æˆ– å…¶ä»–å…´è¶£ç‚¹</li>
                        <li>è‹¥æ— ç»“æœï¼Œè¯·å°è¯•é‡ç½®å¹¶æ›´ç²¾ç¡®åœ°ç‚¹å‡»</li>
                        <li>ç§å­å›¾ç‰‡ä¼šå±•ç¤ºç²¾ç¡®å¸ƒå±€ç”¨äºæ ¸å¯¹</li>
                        <li>åœ¨æ ‡è®°å…´è¶£ç‚¹ä¹‹å‰ï¼Œå…ˆé€‰æ‹©å¤œç‹ä¸åœ°å›¾</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Context Menu for Right Click -->
    <div id="poi-context-menu" class="context-menu" style="display: none;">
        <div class="context-menu-item" data-type="mage">
            <img src="assets/images/mage-tower.png" style="width: 16px; height: 16px; margin-right: 8px; vertical-align: middle;">
            æ³•å¸ˆå¡”
        </div>
        <div class="context-menu-item" data-type="village">
            <img src="assets/images/village.png" style="width: 16px; height: 16px; margin-right: 8px; vertical-align: middle;">
            å•†äººæ‘è½
        </div>
        <div class="context-menu-item" data-type="other">
            <i class="fas fa-question-circle"></i>
            å…¶ä»–å…´è¶£ç‚¹
        </div>
    </div>

    <footer class="footer">
        <p class="footer-text">
            <i class="fa-regular fa-heart" style="margin-right: 4px; color: #ff4d4f;"></i>
            Modified & Localized by <a class="footer-link" href="https://github.com/xxiixi" target="_blank">Cecilia</a> ï½œ
            <i class="fab fa-github" style="margin: 0 4px 0 8px;"></i>
            Forked from <a class="footer-link" href="https://github.com/thanosapollo/nightreign-mapseed-recogniser" target="_blank">thanosapollo/nightreign-mapseed-recogniser</a>
        </p>
        <p class="footer-text">
            Â© <span id="current-year">2025</span> NightreignMapseedFilter Â· All Rights Reserved Â· Last updated: <span id="last-updated">September 5, 2025</span>
        </p>
    </footer>

    <script>
        (function () {
            try {
                var yearEl = document.getElementById('current-year');
                var lastUpdatedEl = document.getElementById('last-updated');
                var statsBtn = document.getElementById('action-stats');
                var helpBtn = document.getElementById('action-help');
                var tbdBtn = document.getElementById('action-tbd');
                var statsPopover = document.getElementById('stats-popover');
                var repoBtn = document.getElementById('action-repo');
                var repoPopover = document.getElementById('repo-popover');
                var now = new Date();
                if (yearEl) {
                    yearEl.textContent = String(now.getFullYear());
                }
                var parsed = new Date(document.lastModified);
                if (!isNaN(parsed.getTime()) && lastUpdatedEl) {
                    var formatted = parsed.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    lastUpdatedEl.textContent = formatted;
                }

                // ç®€æ˜“äº¤äº’ï¼šè®¿é—®é‡å¼¹å±‚ã€å¸®åŠ©å¼¹çª—ã€å¾…å®šå ä½
                if (statsBtn && statsPopover) {
                    statsBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        var willShow = statsPopover.style.display === 'none';
                        // äº’æ–¥ï¼šå¼€å¯å½“å‰å‰å…ˆå…³é—­å¯¹æ–¹
                        if (repoPopover) repoPopover.style.display = 'none';
                        statsPopover.style.display = willShow ? 'block' : 'none';
                    });
                    document.addEventListener('click', function () {
                        statsPopover.style.display = 'none';
                        if (repoPopover) repoPopover.style.display = 'none';
                    });
                    statsPopover.addEventListener('click', function (e) { e.stopPropagation(); });
                }

                if (helpBtn) {
                    helpBtn.addEventListener('click', function () {
                        var helpModal = document.getElementById('help-modal');
                        if (helpModal) helpModal.style.display = 'flex';
                    });
                }

                if (tbdBtn) {
                    tbdBtn.addEventListener('click', function () {
                        alert('åŠŸèƒ½å¾…å®šï¼Œæ•¬è¯·æœŸå¾…');
                    });
                }

                // æŸ¥çœ‹æºç ï¼šå…ˆå¼¹å‡º Popoverï¼Œå†ç‚¹å‡»é“¾æ¥è·³è½¬
                if (repoBtn && repoPopover) {
                    repoBtn.addEventListener('click', function (e) {
                        e.stopPropagation();
                        var willShow = repoPopover.style.display === 'none';
                        // äº’æ–¥ï¼šå¼€å¯å½“å‰å‰å…ˆå…³é—­å¯¹æ–¹
                        if (statsPopover) statsPopover.style.display = 'none';
                        repoPopover.style.display = willShow ? 'block' : 'none';
                    });
                    document.addEventListener('click', function () {
                        repoPopover.style.display = 'none';
                        if (statsPopover) statsPopover.style.display = 'none';
                    });
                    repoPopover.addEventListener('click', function (e) { e.stopPropagation(); });
                }
            } catch (e) {
                // ignore
            }
        })();
    </script>
    <script src="data.js"></script>
    <script src="script.js"></script>
</body>
</html>
